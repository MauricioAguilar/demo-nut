generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int            @id @default(autoincrement())
  createdAt       DateTime       @default(now())
  email           String         @unique
  name            String
  role            String
  retrospectiveId Int?
  Retrospective   Retrospective? @relation(fields: [retrospectiveId], references: [id])
  Invite          Invite[]
  RetroItem       RetroItem[]
  Workspace       Workspace[]
}

model Workspace {
  id        Int             @id @default(autoincrement())
  createdAt DateTime        @default(now())
  userId    Int
  owner     User            @relation(fields: [userId], references: [id])
  Link      Link[]
  retros    Retrospective[]
}

model Retrospective {
  id              Int             @id @default(autoincrement())
  createdAt       DateTime        @default(now())
  name            String
  date            DateTime
  link            String
  workspaceId     Int?
  Workspace       Workspace?      @relation(fields: [workspaceId], references: [id])
  Invite          Invite[]
  itemCollections ItemColletion[]
  Link            Link[]
  items           RetroItem[]
  participants    User[]
}

model RetroItem {
  id              Int           @id @default(autoincrement())
  createdAt       DateTime      @default(now())
  content         String
  type            String
  userId          Int
  retrospectiveId Int
  itemColletionId Int
  ItemColletion   ItemColletion @relation(fields: [itemColletionId], references: [id])
  Retrospective   Retrospective @relation(fields: [retrospectiveId], references: [id])
  author          User          @relation(fields: [userId], references: [id])
}

model ItemColletion {
  id              Int           @id @default(autoincrement())
  createdAt       DateTime      @default(now())
  votes           Int
  retrospectiveId Int
  Retrospective   Retrospective @relation(fields: [retrospectiveId], references: [id])
  items           RetroItem[]
}

model Invite {
  id              Int           @id @default(autoincrement())
  createdAt       DateTime      @default(now())
  userId          Int
  retrospectiveId Int
  retro           Retrospective @relation(fields: [retrospectiveId], references: [id])
  invitee         User          @relation(fields: [userId], references: [id])
}

model Link {
  id              Int           @id @default(autoincrement())
  createdAt       DateTime      @default(now())
  url             String
  expiration      DateTime
  retrospectiveId Int
  workspaceId     Int
  retro           Retrospective @relation(fields: [retrospectiveId], references: [id])
  workspace       Workspace     @relation(fields: [workspaceId], references: [id])
}
